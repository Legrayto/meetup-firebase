{"remainingRequest":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jean/Документы/GitHub/meetup-firebase/src/components/edit/EditProfile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jean/Документы/GitHub/meetup-firebase/src/components/edit/EditProfile.vue","mtime":1645140187775},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgdXNlcjogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgIH0sCiAgICBpc05ld1VzZXI6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiBmYWxzZSwKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nOiBmYWxzZSwKICAgICAgdmFsaWQ6IHRydWUsCiAgICAgIHJ1bGVzOiBbCiAgICAgICAgKHYpID0+ICEhdiB8fCAiRmllbGQgaXMgcmVxdWlyZWQiLAogICAgICAgICh2KSA9PiAvXihbYS16XSspJC9pLnRlc3QodikgfHwgIkZpZWxkIGNvbnRhaW5zIG9ubHkgbGV0dGVycyIsCiAgICAgIF0sCiAgICAgIGVkaXRGaXJzdE5hbWU6ICIiLAogICAgICBlZGl0TGFzdE5hbWU6ICIiLAogICAgICBlZGl0TWlkZGxlTmFtZTogIiIsCiAgICAgIGZpbGVBdmF0YXI6IG51bGwsCiAgICAgIHVybEF2YXRhcjogIiIsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgY2hhbmdlUHJvZmlsZSgpIHsKICAgICAgaWYgKHRoaXMuaXNOZXdVc2VyKSB7CiAgICAgICAgdGhpcy5zZXROZXdQcm9maWxlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lZGl0T2xkUHJvZmlsZSgpOwogICAgICB9CiAgICB9LAoKICAgIHNldE5ld1Byb2ZpbGUoKSB7CiAgICAgIGNvbnN0IGluZm8gPSB7fTsKICAgICAgY29uc3QgZnVsbE5hbWUgPSB0aGlzLmZ1bGxOYW1lKCk7CgogICAgICBpbmZvLm5hbWUgPSBmdWxsTmFtZTsKICAgICAgaW5mby5hdmF0YXIgPSB0aGlzLmZpbGVBdmF0YXI7CgogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZWRpdFVzZXJJbmZvIiwgaW5mbyk7CiAgICAgIHRoaXMuZGlhbG9nID0gZmFsc2U7CiAgICB9LAoKICAgIGVkaXRPbGRQcm9maWxlKCkgewogICAgICBjb25zdCBub3RDYW5nZSA9CiAgICAgICAgdGhpcy5mdWxsTmFtZSgpID09PSB0aGlzLnVzZXIubmFtZSAmJgogICAgICAgIHRoaXMudXJsQXZhdGFyID09PSB0aGlzLnVzZXIuYXZhdGFyOwoKICAgICAgaWYgKG5vdENhbmdlKSB7CiAgICAgICAgdGhpcy5kaWFsb2cgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGluZm8gPSB7fTsKICAgICAgY29uc3QgZnVsbE5hbWUgPSB0aGlzLmZ1bGxOYW1lKCk7CiAgICAgIGluZm8ubmFtZSA9IGZ1bGxOYW1lOwoKICAgICAgaWYgKHRoaXMudXJsQXZhdGFyICE9PSB0aGlzLnVzZXIuYXZhdGFyKSB7CiAgICAgICAgaW5mby5hdmF0YXIgPSB0aGlzLmZpbGVBdmF0YXI7CiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJlZGl0VXNlckluZm8iLCBpbmZvKTsKICAgICAgdGhpcy5kaWFsb2cgPSBmYWxzZTsKICAgIH0sCgogICAgZnVsbE5hbWUoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLmVkaXRGaXJzdE5hbWUudHJpbSgpfSAke3RoaXMuZWRpdExhc3ROYW1lLnRyaW0oKX0gJHt0aGlzLmVkaXRNaWRkbGVOYW1lLnRyaW0oKX1gOwogICAgfSwKCiAgICB2YWxpZGF0ZSgpIHsKICAgICAgdGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCk7CiAgICB9LAoKICAgIG9uRmlsZUF2YXRhcigpIHsKICAgICAgdGhpcy4kcmVmcy5maWxlSW5wdXQuY2xpY2soKTsKICAgIH0sCgogICAgb25GaWxlQ2hhbmdlZChlKSB7CiAgICAgIHRoaXMuZmlsZUF2YXRhciA9IGUudGFyZ2V0LmZpbGVzWzBdOwogICAgICBpZiAodGhpcy5maWxlQXZhdGFyKSB7CiAgICAgICAgY29uc3QgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgZmlsZVJlYWRlci5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgKCkgPT4gewogICAgICAgICAgdGhpcy51cmxBdmF0YXIgPSBmaWxlUmVhZGVyLnJlc3VsdDsKICAgICAgICB9KTsKICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwodGhpcy5maWxlQXZhdGFyKTsKICAgICAgfQogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBpZiAoIXRoaXMuaXNOZXdVc2VyKSB7CiAgICAgIFt0aGlzLmVkaXRGaXJzdE5hbWUsIHRoaXMuZWRpdExhc3ROYW1lLCB0aGlzLmVkaXRNaWRkbGVOYW1lXSA9CiAgICAgICAgdGhpcy51c2VyLm5hbWUuc3BsaXQoIiAiKTsKICAgICAgdGhpcy51cmxBdmF0YXIgPSB0aGlzLnVzZXIuYXZhdGFyOwogICAgfQogIH0sCn07Cg=="},{"version":3,"sources":["EditProfile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditProfile.vue","sourceRoot":"src/components/edit","sourcesContent":["<template>\n  <v-dialog v-model=\"dialog\" persistent max-width=\"600\">\n    <template v-slot:activator=\"{ on, attrs }\">\n      <v-btn color=\"red\" dark block v-bind=\"attrs\" v-on=\"on\" v-if=\"isNewUser\">\n        Edit Profile\n      </v-btn>\n      <v-btn v-else v-bind=\"attrs\" v-on=\"on\" text>\n        <v-icon>mdi-pencil</v-icon>\n      </v-btn>\n    </template>\n    <v-card>\n      <v-card-title>Edit Profile</v-card-title>\n      <v-divider class=\"mb-5\"></v-divider>\n      <v-card-text>\n        <v-row>\n          <v-col cols=\"4\" class=\"d-flex justify-center\">\n            <v-avatar\n              color=\"grey lighten-4\"\n              size=\"150\"\n              class=\"elevation-3\"\n              @click=\"onFileAvatar\"\n            >\n              <v-img v-if=\"this.urlAvatar\" :src=\"this.urlAvatar\"></v-img>\n              <v-icon v-else large color=\"grey lighten-1\">mdi-plus</v-icon>\n            </v-avatar>\n            <input\n              ref=\"fileInput\"\n              class=\"d-none\"\n              type=\"file\"\n              accept=\"image/*\"\n              @change=\"onFileChanged\"\n            />\n          </v-col>\n          <v-col cols=\"8\">\n            <v-form ref=\"form\" v-model=\"valid\">\n              <v-text-field\n                label=\"FirstName\"\n                :rules=\"rules\"\n                v-model=\"editFirstName\"\n                clearable\n              ></v-text-field>\n              <v-text-field\n                label=\"LastName\"\n                :rules=\"rules\"\n                v-model=\"editLastName\"\n                clearable\n              ></v-text-field>\n              <v-text-field\n                label=\"MiddleName\"\n                v-model=\"editMiddleName\"\n                :rules=\"rules\"\n                clearable\n              ></v-text-field>\n            </v-form>\n          </v-col>\n        </v-row>\n      </v-card-text>\n\n      <v-card-actions>\n        <v-btn text color=\"primary\" @click=\"dialog = false\">Close</v-btn>\n        <v-btn\n          text\n          color=\"accent\"\n          @click=\"changeProfile\"\n          :disabled=\"!valid || urlAvatar === ''\"\n          >Change</v-btn\n        >\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nexport default {\n  props: {\n    user: {\n      type: Object,\n      required: false,\n    },\n    isNewUser: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      dialog: false,\n      valid: true,\n      rules: [\n        (v) => !!v || \"Field is required\",\n        (v) => /^([a-z]+)$/i.test(v) || \"Field contains only letters\",\n      ],\n      editFirstName: \"\",\n      editLastName: \"\",\n      editMiddleName: \"\",\n      fileAvatar: null,\n      urlAvatar: \"\",\n    };\n  },\n  methods: {\n    changeProfile() {\n      if (this.isNewUser) {\n        this.setNewProfile();\n      } else {\n        this.editOldProfile();\n      }\n    },\n\n    setNewProfile() {\n      const info = {};\n      const fullName = this.fullName();\n\n      info.name = fullName;\n      info.avatar = this.fileAvatar;\n\n      this.$store.dispatch(\"editUserInfo\", info);\n      this.dialog = false;\n    },\n\n    editOldProfile() {\n      const notCange =\n        this.fullName() === this.user.name &&\n        this.urlAvatar === this.user.avatar;\n\n      if (notCange) {\n        this.dialog = false;\n        return;\n      }\n\n      const info = {};\n      const fullName = this.fullName();\n      info.name = fullName;\n\n      if (this.urlAvatar !== this.user.avatar) {\n        info.avatar = this.fileAvatar;\n      }\n\n      this.$store.dispatch(\"editUserInfo\", info);\n      this.dialog = false;\n    },\n\n    fullName() {\n      return `${this.editFirstName.trim()} ${this.editLastName.trim()} ${this.editMiddleName.trim()}`;\n    },\n\n    validate() {\n      this.$refs.form.validate();\n    },\n\n    onFileAvatar() {\n      this.$refs.fileInput.click();\n    },\n\n    onFileChanged(e) {\n      this.fileAvatar = e.target.files[0];\n      if (this.fileAvatar) {\n        const fileReader = new FileReader();\n        fileReader.addEventListener(\"load\", () => {\n          this.urlAvatar = fileReader.result;\n        });\n        fileReader.readAsDataURL(this.fileAvatar);\n      }\n    },\n  },\n  created() {\n    if (!this.isNewUser) {\n      [this.editFirstName, this.editLastName, this.editMiddleName] =\n        this.user.name.split(\" \");\n      this.urlAvatar = this.user.avatar;\n    }\n  },\n};\n</script>\n"]}]}