{"remainingRequest":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jean/Документы/GitHub/meetup-firebase/src/components/edit/EditProfile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jean/Документы/GitHub/meetup-firebase/src/components/edit/EditProfile.vue","mtime":1645152820986},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/jean/Документы/GitHub/meetup-firebase/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgdXNlcjogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgIH0sCiAgICBpc05ld1VzZXI6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiBmYWxzZSwKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nOiBmYWxzZSwKICAgICAgdmFsaWQ6IHRydWUsCiAgICAgIHJ1bGVzOiBbCiAgICAgICAgKHYpID0+ICEhdiB8fCAiRmllbGQgaXMgcmVxdWlyZWQiLAogICAgICAgICh2KSA9PiAvXihbYS16XSspJC9pLnRlc3QodikgfHwgIkZpZWxkIGNvbnRhaW5zIG9ubHkgbGV0dGVycyIsCiAgICAgIF0sCiAgICAgIHJ1bGVzRW1haWw6IFsKICAgICAgICAodikgPT4gISF2IHx8ICJGaWVsZCBpcyByZXF1aXJlZCIsCiAgICAgICAgKHYpID0+IC8uK0AuK1wuLisvLnRlc3QodikgfHwgIkUtbWFpbCBtdXN0IGJlIHZhbGlkIiwKICAgICAgXSwKICAgICAgcnVsZXNMb2dpbjogWwogICAgICAgICh2KSA9PiAhIXYgfHwgIkZpZWxkIGlzIHJlcXVpcmVkIiwKICAgICAgICAodikgPT4KICAgICAgICAgIC9eW2EtekEtWl1bMC05X2EtekEtel0qW2EtekEtejAtOV0rJC8udGVzdCh2KSB8fAogICAgICAgICAgIkxvZ2luIG11c3QgYmUgdmFsaWQiLAogICAgICBdLAogICAgICBlZGl0Rmlyc3ROYW1lOiAiIiwKICAgICAgZWRpdExhc3ROYW1lOiAiIiwKICAgICAgZWRpdE1pZGRsZU5hbWU6ICIiLAogICAgICBlZGl0RW1haWw6ICIiLAogICAgICBmaWxlQXZhdGFyOiBudWxsLAogICAgICB1cmxBdmF0YXI6ICIiLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNoYW5nZVByb2ZpbGUoKSB7CiAgICAgIGlmICh0aGlzLmlzTmV3VXNlcikgewogICAgICAgIHRoaXMuc2V0TmV3UHJvZmlsZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZWRpdE9sZFByb2ZpbGUoKTsKICAgICAgfQogICAgfSwKCiAgICBzZXROZXdQcm9maWxlKCkgewogICAgICBjb25zdCBpbmZvID0ge307CiAgICAgIGNvbnN0IGZ1bGxOYW1lID0gdGhpcy5mdWxsTmFtZSgpOwoKICAgICAgaW5mby5uYW1lID0gZnVsbE5hbWU7CiAgICAgIGluZm8uYXZhdGFyID0gdGhpcy5maWxlQXZhdGFyOwoKICAgICAgaWYgKHRoaXMuZWRpdEVtYWlsICE9PSB0aGlzLnVzZXIuZW1haWwpIHsKICAgICAgICBpbmZvLmVtYWlsID0gdGhpcy5lZGl0RW1haWw7CiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJlZGl0VXNlckluZm8iLCBpbmZvKTsKICAgICAgdGhpcy5kaWFsb2cgPSBmYWxzZTsKICAgIH0sCgogICAgZWRpdE9sZFByb2ZpbGUoKSB7CiAgICAgIGNvbnN0IG5vdENhbmdlID0KICAgICAgICB0aGlzLmZ1bGxOYW1lKCkgPT09IHRoaXMudXNlci5uYW1lICYmCiAgICAgICAgdGhpcy51cmxBdmF0YXIgPT09IHRoaXMudXNlci5hdmF0YXIgJiYKICAgICAgICB0aGlzLmVkaXRFbWFpbCA9PT0gdGhpcy51c2VyLmVtYWlsICYmCiAgICAgICAgdGhpcy5lZGl0TG9naW4gPT09IHRoaXMudXNlci5sb2dpbjsKCiAgICAgIGlmIChub3RDYW5nZSkgewogICAgICAgIHRoaXMuZGlhbG9nID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBpbmZvID0ge307CiAgICAgIGNvbnN0IGZ1bGxOYW1lID0gdGhpcy5mdWxsTmFtZSgpOwoKICAgICAgaW5mby5uYW1lID0gZnVsbE5hbWU7CgogICAgICBpZiAodGhpcy5lZGl0RW1haWwgIT09IHRoaXMudXNlci5lbWFpbCkgewogICAgICAgIGluZm8uZW1haWwgPSB0aGlzLmVkaXRFbWFpbDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudXJsQXZhdGFyICE9PSB0aGlzLnVzZXIuYXZhdGFyKSB7CiAgICAgICAgaW5mby5hdmF0YXIgPSB0aGlzLmZpbGVBdmF0YXI7CiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJlZGl0VXNlckluZm8iLCBpbmZvKTsKICAgICAgdGhpcy5kaWFsb2cgPSBmYWxzZTsKICAgIH0sCgogICAgZnVsbE5hbWUoKSB7CiAgICAgIHJldHVybiBgJHt0aGlzLmVkaXRGaXJzdE5hbWUudHJpbSgpfSAke3RoaXMuZWRpdExhc3ROYW1lLnRyaW0oKX0gJHt0aGlzLmVkaXRNaWRkbGVOYW1lLnRyaW0oKX1gOwogICAgfSwKCiAgICB2YWxpZGF0ZSgpIHsKICAgICAgdGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCk7CiAgICB9LAoKICAgIG9uRmlsZUF2YXRhcigpIHsKICAgICAgdGhpcy4kcmVmcy5maWxlSW5wdXQuY2xpY2soKTsKICAgIH0sCgogICAgb25GaWxlQ2hhbmdlZChlKSB7CiAgICAgIHRoaXMuZmlsZUF2YXRhciA9IGUudGFyZ2V0LmZpbGVzWzBdOwoKICAgICAgaWYgKHRoaXMuZmlsZUF2YXRhcikgewogICAgICAgIGNvbnN0IGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgIGZpbGVSZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsICgpID0+IHsKICAgICAgICAgIHRoaXMudXJsQXZhdGFyID0gZmlsZVJlYWRlci5yZXN1bHQ7CiAgICAgICAgfSk7CiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKHRoaXMuZmlsZUF2YXRhcik7CiAgICAgIH0KICAgIH0sCiAgfSwKCiAgbW91dGVkKCkgewogICAgaWYgKCF0aGlzLmlzTmV3VXNlcikgewogICAgICBbdGhpcy5lZGl0Rmlyc3ROYW1lLCB0aGlzLmVkaXRMYXN0TmFtZSwgdGhpcy5lZGl0TWlkZGxlTmFtZV0gPQogICAgICAgIHRoaXMudXNlci5uYW1lLnNwbGl0KCIgIik7CiAgICAgIHRoaXMudXJsQXZhdGFyID0gdGhpcy51c2VyLmF2YXRhcjsKICAgICAgdGhpcy5lZGl0RW1haWwgPSB0aGlzLnVzZXIuZW1haWw7CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["EditProfile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditProfile.vue","sourceRoot":"src/components/edit","sourcesContent":["<template>\n  <v-dialog v-model=\"dialog\" persistent max-width=\"600\">\n    <template v-slot:activator=\"{ on, attrs }\">\n      <v-btn color=\"red\" dark block v-bind=\"attrs\" v-on=\"on\" v-if=\"isNewUser\">\n        Add Profile\n      </v-btn>\n      <v-btn v-else v-bind=\"attrs\" v-on=\"on\" text>\n        <v-icon>mdi-pencil</v-icon>\n      </v-btn>\n    </template>\n    <v-card>\n      <v-card-title>Edit Profile</v-card-title>\n      <v-divider class=\"mb-5\"></v-divider>\n      <v-card-text>\n        <v-row>\n          <v-col cols=\"12\" md=\"4\" class=\"d-flex justify-center\">\n            <v-avatar\n              color=\"grey lighten-4\"\n              size=\"150\"\n              class=\"elevation-3\"\n              @click=\"onFileAvatar\"\n            >\n              <v-img v-if=\"this.urlAvatar\" :src=\"this.urlAvatar\"></v-img>\n              <v-icon v-else large color=\"grey lighten-1\">mdi-plus</v-icon>\n            </v-avatar>\n            <input\n              ref=\"fileInput\"\n              class=\"d-none\"\n              type=\"file\"\n              accept=\"image/*\"\n              @change=\"onFileChanged\"\n            />\n          </v-col>\n          <v-col cols=\"12\" md=\"8\">\n            <v-form ref=\"form\" v-model=\"valid\">\n              <v-text-field\n                label=\"FirstName\"\n                :rules=\"rules\"\n                v-model=\"editFirstName\"\n                clearable\n              ></v-text-field>\n              <v-text-field\n                label=\"LastName\"\n                :rules=\"rules\"\n                v-model=\"editLastName\"\n                clearable\n              ></v-text-field>\n              <v-text-field\n                label=\"MiddleName\"\n                v-model=\"editMiddleName\"\n                :rules=\"rules\"\n                clearable\n              ></v-text-field>\n              <v-text-field\n                label=\"Email\"\n                v-if=\"!isNewUser\"\n                v-model=\"editEmail\"\n                :rules=\"rulesEmail\"\n                clearable\n              ></v-text-field>\n            </v-form>\n          </v-col>\n        </v-row>\n      </v-card-text>\n\n      <v-card-actions>\n        <v-btn text color=\"primary\" @click=\"dialog = false\">Close</v-btn>\n        <v-btn\n          text\n          color=\"accent\"\n          @click=\"changeProfile\"\n          :disabled=\"!valid || urlAvatar === ''\"\n          >Change</v-btn\n        >\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nexport default {\n  props: {\n    user: {\n      type: Object,\n      required: false,\n    },\n    isNewUser: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      dialog: false,\n      valid: true,\n      rules: [\n        (v) => !!v || \"Field is required\",\n        (v) => /^([a-z]+)$/i.test(v) || \"Field contains only letters\",\n      ],\n      rulesEmail: [\n        (v) => !!v || \"Field is required\",\n        (v) => /.+@.+\\..+/.test(v) || \"E-mail must be valid\",\n      ],\n      rulesLogin: [\n        (v) => !!v || \"Field is required\",\n        (v) =>\n          /^[a-zA-Z][0-9_a-zA-z]*[a-zA-z0-9]+$/.test(v) ||\n          \"Login must be valid\",\n      ],\n      editFirstName: \"\",\n      editLastName: \"\",\n      editMiddleName: \"\",\n      editEmail: \"\",\n      fileAvatar: null,\n      urlAvatar: \"\",\n    };\n  },\n  methods: {\n    changeProfile() {\n      if (this.isNewUser) {\n        this.setNewProfile();\n      } else {\n        this.editOldProfile();\n      }\n    },\n\n    setNewProfile() {\n      const info = {};\n      const fullName = this.fullName();\n\n      info.name = fullName;\n      info.avatar = this.fileAvatar;\n\n      if (this.editEmail !== this.user.email) {\n        info.email = this.editEmail;\n      }\n\n      this.$store.dispatch(\"editUserInfo\", info);\n      this.dialog = false;\n    },\n\n    editOldProfile() {\n      const notCange =\n        this.fullName() === this.user.name &&\n        this.urlAvatar === this.user.avatar &&\n        this.editEmail === this.user.email &&\n        this.editLogin === this.user.login;\n\n      if (notCange) {\n        this.dialog = false;\n        return;\n      }\n\n      const info = {};\n      const fullName = this.fullName();\n\n      info.name = fullName;\n\n      if (this.editEmail !== this.user.email) {\n        info.email = this.editEmail;\n      }\n\n      if (this.urlAvatar !== this.user.avatar) {\n        info.avatar = this.fileAvatar;\n      }\n\n      this.$store.dispatch(\"editUserInfo\", info);\n      this.dialog = false;\n    },\n\n    fullName() {\n      return `${this.editFirstName.trim()} ${this.editLastName.trim()} ${this.editMiddleName.trim()}`;\n    },\n\n    validate() {\n      this.$refs.form.validate();\n    },\n\n    onFileAvatar() {\n      this.$refs.fileInput.click();\n    },\n\n    onFileChanged(e) {\n      this.fileAvatar = e.target.files[0];\n\n      if (this.fileAvatar) {\n        const fileReader = new FileReader();\n        fileReader.addEventListener(\"load\", () => {\n          this.urlAvatar = fileReader.result;\n        });\n        fileReader.readAsDataURL(this.fileAvatar);\n      }\n    },\n  },\n\n  mouted() {\n    if (!this.isNewUser) {\n      [this.editFirstName, this.editLastName, this.editMiddleName] =\n        this.user.name.split(\" \");\n      this.urlAvatar = this.user.avatar;\n      this.editEmail = this.user.email;\n    }\n  },\n};\n</script>\n"]}]}